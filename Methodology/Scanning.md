# Scanning

- When scanning a network range, it is important to conduct a ping sweep first in order to find live hosts. Without determining live hosts, network scans could take copious amounts of time (depending on the size of the network).
- When conducting a ping sweep, it is easiest to send the output of the scan to an nmap grepable file or a text file so that changes can be easily made to the file for the actual network scan.

Nmap:

`nmap -T4 -sn <ip-range> -oG filename`
* There is no need to put an extension on the filename, nmap already knows to do this by using the oG flag.
* Adding `--source-port 80` to the ping sweep may return a better outcome, but it's really dependent on the network.

Masscan:

- After completion of the ping sweep, utilize the gnmap file to build a live hosts file (grep for hosts that are determined to be up and redirect the output to a file). This way your not scanning hosts in the network range that more than likely aren't present.

`grep -i 'Up' <filename> | cut -f 2 -d ' ' > <hostfile.txt>` 

- Now that a live host file has been built, run the scan against the IPs outlined in the host file. There are many ways to run scans against the hosts depending on the objective and the level of initial scanning that you want to do. Below is a good baseline scan to run.

Nmap:
TCP -
`nmap -Pn -O -sV -T4 -p- --open --reason -iL <hostfile.txt> -oA <scan_name>` 
* `-sS` is excluded from above because it is the default mode nmap will scan in
* There are tons of other options that can be added to the scan to be faster or to pull more information

UDP -
`nmap -Pn -n -sU -T4 --open --max-retries=0 -p- -oA <scan_name> -iL <hostfile.txt>`
* There are tons of other options to add to this scan as well
* If you're not worried about scanning all ports for UDP, don't include `-p-` and allow nmap to only scan common ports, this will allow for faster scanning as well


Masscan:



## OLD
4. Convert nmap results to a spreadsheet for easier views:
python3 /path/to/nmap_parser.py –csv &lt;filename.csv&gt; -f &lt;nmapfile.xml&gt;

5. Review spreadsheet to gather a baseline of what’s on the network:
After the spreadsheet has been produced, look through and establish what the baseline of the
network is. During this step, you should be looking for common services that are on most of the
machines on the network. Understanding the baseline will allow you to figure out what should be
there and what shouldn’t be there. After figuring the baseline out, this is when you want to find any
“low hanging fruit” that may be easily exploited. Insecure protocols such as FTP or Telnet may lead to
an anonymous login (FTP) or unauthenticated shell access (Telnet). If any HTTP(S) ports are open,
note those hosts so that you can browse to the web pages and get an understanding of what the
machines purpose is or what is on the machine. If port 9100 is open, then you automatically know
that the machine is a printer and can easily be exploited with PRET (more to follow on this later).
